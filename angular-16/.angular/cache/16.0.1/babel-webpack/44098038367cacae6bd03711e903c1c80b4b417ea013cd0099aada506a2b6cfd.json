{"ast":null,"code":"import { __decorate } from \"tslib\";\n// src/app/components/classifier/classifier.component.ts\nimport { Component } from '@angular/core';\nimport * as L from 'leaflet';\nlet ClassifierComponent = class ClassifierComponent {\n  constructor(svc) {\n    this.svc = svc;\n    this.tileUrl = null;\n    this.prediction = null;\n    this.loading = false;\n    this.error = null;\n  }\n  ngAfterViewInit() {\n    // Initialize Leaflet map when view is ready\n    this.map = L.map('map', {\n      maxBounds: L.latLngBounds([-90, -180], [90, 180]),\n      maxBoundsViscosity: 1.0\n    }).setView([36.8065, 10.1815], 13);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap'\n    }).addTo(this.map);\n    // Force map to recalculate its size\n    setTimeout(() => this.map.invalidateSize(), 0);\n    // Register click handler to capture lat/lon\n    this.map.on('click', e => {\n      this.lat = e.latlng.lat;\n      this.lon = e.latlng.lng;\n    });\n    // Prevent map from intercepting form button clicks\n    const button = document.querySelector('.classifier-form button');\n    if (button) {\n      L.DomEvent.disableClickPropagation(button);\n    }\n  }\n  onSubmit() {\n    if (this.lat == null || this.lon == null) {\n      this.error = 'Please select a location on the map first.';\n      return;\n    }\n    this.reset();\n    this.loading = true;\n    this.svc.predict(this.lat, this.lon).subscribe({\n      next: res => {\n        this.tileUrl = `data:image/png;base64,${res.tile}`;\n        this.prediction = res.prediction;\n        this.loading = false;\n      },\n      error: () => {\n        this.error = 'Failed to load tile or prediction.';\n        this.loading = false;\n      }\n    });\n  }\n  reset() {\n    this.tileUrl = null;\n    this.prediction = null;\n    this.error = null;\n  }\n};\nClassifierComponent = __decorate([Component({\n  selector: 'app-classifier',\n  templateUrl: './classifier.component.html',\n  styleUrls: ['./classifier.component.scss']\n})], ClassifierComponent);\nexport { ClassifierComponent };","map":{"version":3,"names":["Component","L","ClassifierComponent","constructor","svc","tileUrl","prediction","loading","error","ngAfterViewInit","map","maxBounds","latLngBounds","maxBoundsViscosity","setView","tileLayer","attribution","addTo","setTimeout","invalidateSize","on","e","lat","latlng","lon","lng","button","document","querySelector","DomEvent","disableClickPropagation","onSubmit","reset","predict","subscribe","next","res","tile","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\MSI\\Downloads\\admin-pro-angular-lite-master\\admin-pro-angular-lite-master\\angular-16\\src\\app\\pages\\classifier\\classifier.component.ts"],"sourcesContent":["// src/app/components/classifier/classifier.component.ts\nimport { Component, AfterViewInit } from '@angular/core';\nimport * as L from 'leaflet';\n\n@Component({\n  selector: 'app-classifier',\n  templateUrl: './classifier.component.html',\n  styleUrls: ['./classifier.component.scss']\n})\nexport class ClassifierComponent implements AfterViewInit {\n  lat!: number;\n  lon!: number;\n\n  tileUrl: string | null = null;\n  prediction: string | null = null;\n  loading = false;\n  error: string | null = null;\n\n  private map!: L.Map;\n\n  constructor(private svc: ClassificationService) {}\n\n  ngAfterViewInit(): void {\n    // Initialize Leaflet map when view is ready\n    this.map = L.map('map', {\n      maxBounds: L.latLngBounds([-90, -180], [90, 180]),\n      maxBoundsViscosity: 1.0\n    }).setView([36.8065, 10.1815], 13);\n\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap'\n    }).addTo(this.map);\n\n    // Force map to recalculate its size\n    setTimeout(() => this.map.invalidateSize(), 0);\n\n    // Register click handler to capture lat/lon\n    this.map.on('click', (e: L.LeafletMouseEvent) => {\n      this.lat = e.latlng.lat;\n      this.lon = e.latlng.lng;\n    });\n\n    // Prevent map from intercepting form button clicks\n    const button = document.querySelector('.classifier-form button');\n    if (button) {\n      L.DomEvent.disableClickPropagation(button as HTMLElement);\n    }\n  }\n\n  onSubmit(): void {\n    if (this.lat == null || this.lon == null) {\n      this.error = 'Please select a location on the map first.';\n      return;\n    }\n\n    this.reset();\n    this.loading = true;\n\n    this.svc.predict(this.lat, this.lon).subscribe({\n      next: (res) => {\n        this.tileUrl = `data:image/png;base64,${res.tile}`;\n        this.prediction = res.prediction;\n        this.loading = false;\n      },\n      error: () => {\n        this.error = 'Failed to load tile or prediction.';\n        this.loading = false;\n      }\n    });\n  }\n\n  private reset(): void {\n    this.tileUrl = null;\n    this.prediction = null;\n    this.error = null;\n  }\n}\n"],"mappings":";AAAA;AACA,SAASA,SAAS,QAAuB,eAAe;AACxD,OAAO,KAAKC,CAAC,MAAM,SAAS;AAO5B,IAAaC,mBAAmB,GAAhC,MAAaA,mBAAmB;EAW9BC,YAAoBC,GAA0B;IAA1B,KAAAA,GAAG,GAAHA,GAAG;IAPvB,KAAAC,OAAO,GAAkB,IAAI;IAC7B,KAAAC,UAAU,GAAkB,IAAI;IAChC,KAAAC,OAAO,GAAG,KAAK;IACf,KAAAC,KAAK,GAAkB,IAAI;EAIsB;EAEjDC,eAAeA,CAAA;IACb;IACA,IAAI,CAACC,GAAG,GAAGT,CAAC,CAACS,GAAG,CAAC,KAAK,EAAE;MACtBC,SAAS,EAAEV,CAAC,CAACW,YAAY,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;MACjDC,kBAAkB,EAAE;KACrB,CAAC,CAACC,OAAO,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC;IAElCb,CAAC,CAACc,SAAS,CAAC,oDAAoD,EAAE;MAChEC,WAAW,EAAE;KACd,CAAC,CAACC,KAAK,CAAC,IAAI,CAACP,GAAG,CAAC;IAElB;IACAQ,UAAU,CAAC,MAAM,IAAI,CAACR,GAAG,CAACS,cAAc,EAAE,EAAE,CAAC,CAAC;IAE9C;IACA,IAAI,CAACT,GAAG,CAACU,EAAE,CAAC,OAAO,EAAGC,CAAsB,IAAI;MAC9C,IAAI,CAACC,GAAG,GAAGD,CAAC,CAACE,MAAM,CAACD,GAAG;MACvB,IAAI,CAACE,GAAG,GAAGH,CAAC,CAACE,MAAM,CAACE,GAAG;IACzB,CAAC,CAAC;IAEF;IACA,MAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,yBAAyB,CAAC;IAChE,IAAIF,MAAM,EAAE;MACVzB,CAAC,CAAC4B,QAAQ,CAACC,uBAAuB,CAACJ,MAAqB,CAAC;;EAE7D;EAEAK,QAAQA,CAAA;IACN,IAAI,IAAI,CAACT,GAAG,IAAI,IAAI,IAAI,IAAI,CAACE,GAAG,IAAI,IAAI,EAAE;MACxC,IAAI,CAAChB,KAAK,GAAG,4CAA4C;MACzD;;IAGF,IAAI,CAACwB,KAAK,EAAE;IACZ,IAAI,CAACzB,OAAO,GAAG,IAAI;IAEnB,IAAI,CAACH,GAAG,CAAC6B,OAAO,CAAC,IAAI,CAACX,GAAG,EAAE,IAAI,CAACE,GAAG,CAAC,CAACU,SAAS,CAAC;MAC7CC,IAAI,EAAGC,GAAG,IAAI;QACZ,IAAI,CAAC/B,OAAO,GAAG,yBAAyB+B,GAAG,CAACC,IAAI,EAAE;QAClD,IAAI,CAAC/B,UAAU,GAAG8B,GAAG,CAAC9B,UAAU;QAChC,IAAI,CAACC,OAAO,GAAG,KAAK;MACtB,CAAC;MACDC,KAAK,EAAEA,CAAA,KAAK;QACV,IAAI,CAACA,KAAK,GAAG,oCAAoC;QACjD,IAAI,CAACD,OAAO,GAAG,KAAK;MACtB;KACD,CAAC;EACJ;EAEQyB,KAAKA,CAAA;IACX,IAAI,CAAC3B,OAAO,GAAG,IAAI;IACnB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtB,IAAI,CAACE,KAAK,GAAG,IAAI;EACnB;CACD;AAnEYN,mBAAmB,GAAAoC,UAAA,EAL/BtC,SAAS,CAAC;EACTuC,QAAQ,EAAE,gBAAgB;EAC1BC,WAAW,EAAE,6BAA6B;EAC1CC,SAAS,EAAE,CAAC,6BAA6B;CAC1C,CAAC,C,EACWvC,mBAAmB,CAmE/B;SAnEYA,mBAAmB"},"metadata":{},"sourceType":"module","externalDependencies":[]}